---
layout: default
title: record of batch import case
#excerpt: 

---

#  故事背景

   后台系统批量上传功能，近期业务量激增，动辄90w条excel，解析速度非常慢。使用的解析框架是easy-poi，经过讨论，其他组使用的是easy-excel，虽然都是对poi的封装，但是后者在处理上更适合大量的数据。于是就在项目里，加进了easy-excel的包，写好代码，提测

#  round 1

   在测试过程，发现报错 **classnotfound，发现引入了easy-excel还需要引poi-ooxml三个包，遂加上。

ps：这货好损，编译不报错，启动不报错，运行到那个功能就报错了

#  round 2

   在测试过程，发现解析导入的excel文件，功能是正常了。以为是没事了。万万没想到，升级上去，运营人员反馈导出功能异常。

   what fuck，我改了导入，结果导出有问题了？不信邪，试了上一个版本，结果是正常的，切到当前版本，就异常，这次就死心了。安心下来找问题，果然找到了异常信息，是poi的包内部的错误，说是没有setVal()的方法，经过搜索引擎的努力，发现是poi-3.15有这个方法，poi-3.17就没有这个方法了，不巧，我在easy-excel官网看到的demo，就是poi-3.17，最低是3.17起步支持。

   这就很无语了

​     导出是用的easy-poi，用的poi的版本是3.15，有报错的那个方法

​     导入是用的easy-excel，用的poi的版本是3.17，无报错的那个方法。

   翻了easy-excel，最初的一版，是依赖的poi-3.15，但是，官网的文档没有那么旧版本的，拿新文档去写代码，发现很多类都没有的....

#  结尾

   在进退两难的情况下，最终决定找到替代方案，使用jxl来处理导入，放弃easy-excel


